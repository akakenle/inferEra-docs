---
title: "GPT Image"
description: " "
icon: "palette"
---

## æ¥å£èªªæ˜

OpenAI çš„ç¹ªåœ–æ¥å£ `gpt-image-1`ï¼Œæ”¯æŒæ–‡ç”Ÿåœ–ï¼ˆgenerateï¼‰ã€åœ–æ–‡ç”Ÿåœ–ï¼ˆeditï¼‰ã€‚  
ä½¿ç”¨å‰è«‹é‹è¡Œ `pip install -U openai` å‡ç´šåˆ°æœ€æ–°çš„ openai åŒ…ã€‚

## æ³¨æ„äº‹é …

<Warning>
- ç”Ÿæˆéç¨‹ä¸­ï¼Œç„¡è«–ä»»ä½•æƒ…æ³å°è‡´çš„ä¸­æ–·æˆ–å¤±æ•—ï¼Œ**æ¥å£èª¿ç”¨ä¸€æ—¦ç™¼å‡ºï¼Œéƒ½æœƒè¢«æ‰£å–è²»ç”¨**
- é‚„åœ¨ä¸–çš„è—è¡“å®¶åç¨±ï¼ˆå¦‚ã€Œå®®å´é§¿ã€ã€ã€Œæ–°æµ·èª ã€ç­‰ï¼‰æœƒè§¸ç™¼ `moderation_blocked` å ±éŒ¯ï¼Œ**å°è‡´ç”Ÿæˆå¤±æ•—**ã€‚ä½ å¯ä»¥é€šéã€Œå‰åœåŠ›ã€ã€ã€Œæ˜äº®çš„ç¾ä»£æ—¥å¼å‹•æ¼«é¢¨æ ¼ã€ç­‰éæ•æ„Ÿè©ä¾†è¦é¿ã€‚è¡£è‘—æš´éœ²æˆ–å«æœ‰æš—ç¤ºçš„åœ–ç‰‡åŒç†ã€‚
- ç¸½çš„ä¾†èªª,ã€Œé¢¨æ ¼ã€æ¯”ã€Œè—è¡“å®¶ã€å®‰å…¨ï¼Œåƒæ˜¯ã€Œçš®å…‹æ–¯ã€ä¹Ÿæ˜¯æ”¯æŒçš„ã€‚
- æ›´ç©©å¦¥çš„åšæ³•æ˜¯æ¡ç”¨å·²æ•…è—è¡“å®¶æˆ–å°æ‡‰çš„é¢¨æ ¼ï¼Œå¦‚ã€Œæ¢µé«˜ã€ã€ã€Œè’™å¨œéº—èã€ç­‰ã€‚
</Warning>

## æ¨¡å‹å’Œè²»ç‡

| æ¨¡å‹ | è³ªé‡ | 1024x1024 | 1024x1536 | 1536x1024 |
| ------------------ | ------------ | ------------ | ------------ | ------------ |
| gpt-image-1 | low | $0.011 | $0.016 | $0.016 |
| gpt-image-1 | medium | $0.042 | $0.063 | $0.063 |
| gpt-image-1 | high | $0.167 | $0.25 | $0.25 |

<Info>
æ³¨æ„ï¼šè¼¸å…¥æ–‡æœ¬ Token éƒ¨åˆ†çš„è²»ç‡æ˜¯ $5/ç™¾è¬ Tokensï¼Œé¡å¤–è¨ˆç®—ã€‚
</Info>
  
## èª¿ç”¨æ–¹æ³•

**ç«¯é» (Endpoints)**
1. ç¹ªåœ–ï¼š`https://aihubmix.com/v1/images/generations`
2. ç·¨è¼¯ï¼š`https://aihubmix.com/v1/images/edits`

**Python èª¿ç”¨ç¤ºä¾‹å¦‚ä¸‹ï¼š**  
<CodeGroup>
```py ç”Ÿæˆ (æ–‡ç”Ÿåœ–)
from openai import OpenAI
import base64
import os

client = OpenAI(
    api_key="AIHUBMIX_API_KEY", # æ›æˆä½ åœ¨å¾Œå°ç”Ÿæˆçš„ Key "sk-***"
    base_url="https://aihubmix.com/v1"
)

prompt = """redesign poster of the movie [Black Swan], 3D cartoon, smooth render, bright tone, 2:3 portrait."""

result = client.images.generate(
    model="gpt-image-1",
    prompt=prompt,
    n=1, # å–®æ¬¡å‡ºåœ–æ•¸é‡ï¼Œæœ€å¤š 10 å¼µ
    size="1024x1536", # 1024x1024 (square), 1536x1024 (3:2 landscape), 1024x1536 (2:3 portrait), auto (default) 
    quality="high", # high, medium, low, auto (default)
    moderation="low", # low, auto (default) éœ€è¦å‡ç´š openai åŒ… ğŸ“
    background="auto", # transparent, opaque, auto (default)
)

print(result.usage)

# å®šç¾©æ–‡ä»¶åå‰ç¶´å’Œä¿å­˜ç›®éŒ„
output_dir = "." # å¯ä»¥æŒ‡å®šå…¶ä»–ç›®éŒ„
file_prefix = "image_gen"

# ç¢ºä¿è¼¸å‡ºç›®éŒ„å­˜åœ¨
os.makedirs(output_dir, exist_ok=True)

# éæ­·æ‰€æœ‰è¿”å›çš„åœ–ç‰‡æ•¸æ“š
for i, image_data in enumerate(result.data):
    image_base64 = image_data.b64_json
    if image_base64: # ç¢ºä¿ b64_json ä¸ç‚ºç©º
        image_bytes = base64.b64decode(image_base64)

        # --- æ–‡ä»¶åè¡çªè™•ç†é‚è¼¯é–‹å§‹ ---
        current_index = i
        while True:
            # æ§‹å»ºå¸¶è‡ªå¢åºè™Ÿçš„æ–‡ä»¶å
            file_name = f"{file_prefix}_{current_index}.png"
            file_path = os.path.join(output_dir, file_name) # æ§‹å»ºå®Œæ•´æ–‡ä»¶è·¯å¾‘

            # æª¢æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨
            if not os.path.exists(file_path):
                break # æ–‡ä»¶åä¸è¡çªï¼Œè·³å‡ºå¾ªç’°

            # æ–‡ä»¶åè¡çªï¼Œå¢åŠ åºè™Ÿ
            current_index += 1

        # ä½¿ç”¨æ‰¾åˆ°çš„å”¯ä¸€ file_path ä¿å­˜åœ–ç‰‡åˆ°æ–‡ä»¶
        with open(file_path, "wb") as f:
            f.write(image_bytes)
        print(f"åœ–ç‰‡å·²ä¿å­˜è‡³ï¼š{file_path}")
    else:
        print(f"ç¬¬ {i} å¼µåœ–ç‰‡æ•¸æ“šç‚ºç©ºï¼Œè·³éä¿å­˜ã€‚")

```

```py ç·¨è¼¯ (å¤šåœ–+æ–‡ç”Ÿåœ–)
from openai import OpenAI
import base64
import os

client = OpenAI(
    api_key="AIHUBMIX_API_KEY", # æ›æˆä½ åœ¨å¾Œå°ç”Ÿæˆçš„ Key "sk-***"
    base_url="https://aihubmix.com/v1"
)

prompt = """redesign poster of the movie [Black Swan], 3D cartoon, smooth render, bright tone, 2:3 portrait."""

result = client.images.edit(
    model="gpt-image-1",
    image=open("yourpath/edit.jpg", "rb"), #å¤šåƒè€ƒåœ–æ‡‰ä½¿ç”¨ [åˆ—è¡¨ï¼Œ]
    n=2, # å–®æ¬¡æ•¸é‡
    prompt=prompt,
    size="1024x1536", # 1024x1024 (square), 1536x1024 (3:2 landscape), 1024x1536 (2:3 portrait), auto (default)
    # moderation="low", # edit ä¸æ”¯æŒ moderation
    quality="high" # high, medium, low, auto (default)
)

print(result.usage)

# å®šç¾©æ–‡ä»¶åå‰ç¶´å’Œä¿å­˜ç›®éŒ„
output_dir = "." # å¯ä»¥æŒ‡å®šå…¶ä»–ç›®éŒ„
file_prefix = "image_edit" # ä¿®æ”¹æ–‡ä»¶åå‰ç¶´

# ç¢ºä¿è¼¸å‡ºç›®éŒ„å­˜åœ¨
os.makedirs(output_dir, exist_ok=True)

# --- éæ­· API è¿”å›çš„æ¯å¼µåœ–ç‰‡æ•¸æ“š ---
for i, image_item in enumerate(result.data):
    image_base64 = image_item.b64_json
    if image_base64 is None:
        print(f"è­¦å‘Šï¼šç¬¬ {i+1} å¼µåœ–ç‰‡æ²’æœ‰è¿”å› base64 æ•¸æ“šï¼Œè·³éä¿å­˜ã€‚")
        continue # å¦‚æœæ²¡æœ‰ b64_json æ•¸æ“šï¼Œè·³åˆ°ä¸‹å¼µåœ–ç‰‡

    image_bytes = base64.b64decode(image_base64)

    # --- ç‚ºç•¶å‰åœ–ç‰‡å°‹æ‰¾ä¸è¡çªçš„æ–‡ä»¶å ---
    current_index = 0 # æ¯æ¬¡éƒ½å¾ 0 é–‹å§‹æª¢æŸ¥ï¼Œæˆ–è€…ç¶­è­·ä¸€å€‹å…¨å±€éå¢çš„ç´¢å¼•
    while True:
        # æ§‹å»ºå¸¶è‡ªå¢åºè™Ÿçš„æ–‡ä»¶å
        file_name = f"{file_prefix}_{current_index}.png"
        file_path = os.path.join(output_dir, file_name) # æ§‹å»ºå®Œæ•´æ–‡ä»¶è·¯å¾‘

        # æª¢æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨
        if not os.path.exists(file_path):
            break # æ–‡ä»¶åä¸è¡çªï¼Œè·³å‡ºå…§éƒ¨å¾ªç’°

        # æ–‡ä»¶åè¡çªï¼Œå¢åŠ åºè™Ÿ
        current_index += 1

    # ä½¿ç”¨æ‰¾åˆ°çš„å”¯ä¸€ file_path ä¿å­˜ç•¶å‰åœ–ç‰‡åˆ°æ–‡ä»¶
    try:
        with open(file_path, "wb") as f:
            f.write(image_bytes)
        print(f"ç¬¬ {i+1} å¼µç·¨è¼¯å¾Œçš„åœ–ç‰‡å·²ä¿å­˜è‡³ï¼š{file_path}")
    except Exception as e:
        print(f"ä¿å­˜ç¬¬ {i+1} å¼µåœ–ç‰‡æ™‚å‡ºéŒ¯ ({file_path}): {e}")
```
</CodeGroup>
æ›´å¤šçš„åƒæ•¸ç´°ç¯€å¯ä»¥åƒè€ƒ [OpenAI å®˜æ–¹æ–‡ä»¶](https://platform.openai.com/docs/api-reference/images/create)

## è¼¸å‡ºç¤ºä¾‹
<CodeGroup>
```json ç”Ÿæˆ
Usage(input_tokens=150, input_tokens_details=UsageInputTokensDetails(image_tokens=0, text_tokens=150), output_tokens=6240, total_tokens=6390)
åœ–ç‰‡å·²ä¿å­˜è‡³ï¼š./image_gen_14.png
```

```json ç·¨è¼¯
Usage(input_tokens=992, input_tokens_details=UsageInputTokensDetails(image_tokens=646, text_tokens=346), output_tokens=12480, total_tokens=13472)
ç¬¬ 1 å¼µç·¨è¼¯å¾Œçš„åœ–ç‰‡å·²ä¿å­˜è‡³ï¼š./image_edit_1.png
ç¬¬ 2 å¼µç·¨è¼¯å¾Œçš„åœ–ç‰‡å·²ä¿å­˜è‡³ï¼š./image_edit_2.png
```
</CodeGroup>

## è¢«æ‹’çš„æƒ…æ³

è«‹æ±‚è¢«æ‹’çš„éŒ¯èª¤ä¿¡æ¯å¦‚ä¸‹ï¼š
```json
Error code: 400 - {'error': {'message': 'Your request was rejected as a result of our safety system. Your request may contain content that is not allowed by our safety system.', 'type': 'user_error', 'param': None, 'code': 'moderation_blocked'}}
```

å°æ–¼å–®æ¬¡è«‹æ±‚ç”Ÿæˆ 2-10 å¼µåœ–ç‰‡çš„æƒ…å†µï¼Œå¦‚æœç³»çµ±æª¢æ¸¬åˆ°è«‹æ±‚æ¶‰å«Œé•åå¹³å°æ”¿ç­–ï¼Œè©²è«‹æ±‚ä¸­çš„é•è¦éƒ¨åˆ†å°‡ä¸æœƒè¢«ç”Ÿæˆã€‚é€™å¯èƒ½å°è‡´å¯¦éš›ç”Ÿæˆåœ–ç‰‡æ•¸é‡å°‘æ–¼ç”¨æˆ¶è«‹æ±‚æ•¸é‡ï¼Œç„¶è€Œå¤šåœ–çš„æƒ…å†µä¸‹ï¼Œä¸æœƒæ‹‹å‡º `moderation_blocked`ã€‚ 
å› æ­¤ï¼Œè«‹åœ¨å‰µä½œä¸­ä¸»å‹•è¦é¿æ½›åœ¨çš„çŸ¥è­˜ç”¢æ¬Šï¼ˆIPï¼‰æˆ–ç‰ˆæ¬Šå•é¡Œï¼Œä»¥æ¸›å°‘ç”Ÿæˆè¢«ç³»çµ±æ””æˆªçš„é£é™©ï¼Œç¢ºä¿å‰µä½œé †åˆ©å®Œæˆã€‚

**âœï¸ é—œéµæç¤ºï¼š**
- é¿å…ç›´æ¥ä½¿ç”¨å·²çŸ¥çš„å—ç‰ˆæ¬Šä¿è­·è§’è‰²ã€å“ç‰Œæ¨™èªŒã€åäººè‚–åƒç­‰
- å¯ä»¥æ¡ç”¨ã€Œé¢¨æ ¼å€Ÿé‘’ã€ã€Œå‰µæ„æ”¹ç·¨ã€ã€Œæ³›æŒ‡æè¿°ã€ç­‰æ–¹å¼è¡¨é”
- è‹¥éœ€å¼•ç”¨ç‰¹å®šå…ƒç´ ï¼Œè«‹æå‰ç¢ºèªè©²å…ƒç´ æ˜¯å¦è™•æ–¼å…¬æœ‰é ˜åŸŸ

## å¯¦ç”¨æç¤º

<Tip>
- æ”¯æŒä»»ä½•èªè¨€ï¼Œä¸­æ–‡ç¹ªåˆ¶ä¹Ÿå¾ˆç©©å®šï¼Œä½†æˆ‘å€‘ä¹Ÿä¸å»ºè­°ç¹ªåˆ¶å¤§é‡çš„æ–‡æœ¬
- size åƒæ•¸ä¸æ”¯æŒé¡¯ç¤ºå‚³å…¥ size="auto"ï¼Œé»˜èªå³ auto
- ç•«å¹…æ¯”ä¾‹å¯ä»¥åœ¨ prompt ä¸­æŒ‡å®šï¼Œæ”¯æŒ 2:3ã€3:2ã€1:1ï¼Œä¹Ÿå¯ä»¥åœ¨ size åƒæ•¸ä¸­è¨­ç½®ã€‚
- æ”¯æŒæ§åˆ¶æ•æ„Ÿåº¦çš„ `moderation` åƒæ•¸ï¼Œä½†é€™å€‹åƒæ•¸è¨­ç‚º low ä¹Ÿå¯èƒ½è¢«æ‹’ï¼Œæ¯”å¦‚èªªç¶­ç´æ–¯éæ–¼æš´éœ²
- edits ç«¯å£ä¸æ”¯æŒ `moderation` åƒæ•¸
- æ–‡æœ¬æè¿°å’Œåƒè€ƒåœ–æ­é…ï¼Œèåœ–æ•ˆæœæ›´æº–ç¢º
- ä¸Šå‚³çš„åœ–ç‰‡å¯ä»¥åšå£“ç¸®é è™•ç†ï¼Œæå‡é€Ÿåº¦
- æ”¯æŒé€æ˜èƒŒæ™¯ï¼Œå…æŠ åœ–ã€‚â€”â€”åªéœ€è¦åœ¨ Prompt ä¸­è£œå……è¦æ±‚
</Tip>
