---
title: "GPT Image"
description: " "
icon: "palette"
---

## æ¥å£è¯´æ˜

Azure OpenAI çš„ç»˜å›¾æ¥å£ `gpt-image-1`ï¼Œæ”¯æŒæ–‡ç”Ÿå›¾ï¼ˆgenerateï¼‰ã€å›¾æ–‡ç”Ÿå›¾ï¼ˆeditï¼‰ã€‚  
ä½¿ç”¨å‰è¯·è¿è¡Œ `pip install -U openai` å‡çº§åˆ°æœ€æ–°çš„ openai åŒ…ã€‚

## æ³¨æ„äº‹é¡¹

<Warning>
- ç”Ÿæˆè¿‡ç¨‹ä¸­ï¼Œæ— è®ºä»»ä½•æƒ…å†µå¯¼è‡´çš„ä¸­æ–­æˆ–å¤±è´¥ï¼Œ**æ¥å£è°ƒç”¨ä¸€ç»å‘å‡ºï¼Œéƒ½ä¼šè¢«æ‰£å–è´¹ç”¨**
- è¿˜åœ¨ä¸–çš„è‰ºæœ¯å®¶åç§°ï¼ˆå¦‚ã€Œå®«å´éªã€ã€ã€Œæ–°æµ·è¯šã€ç­‰ï¼‰ä¼šè§¦å‘ `moderation_blocked` æŠ¥é”™ï¼Œ**å¯¼è‡´ç”Ÿæˆå¤±è´¥**ã€‚ä½ å¯ä»¥é€šè¿‡ã€Œå‰åœåŠ›ã€ã€ã€Œæ˜äº®çš„ç°ä»£æ—¥å¼åŠ¨æ¼«é£æ ¼ã€ç­‰éæ•æ„Ÿè¯æ¥è§„é¿ã€‚è¡£ç€æš´éœ²æˆ–å«æœ‰æš—ç¤ºçš„å›¾ç‰‡åŒç†ã€‚
- æ€»çš„æ¥è¯´,ã€Œé£æ ¼ã€æ¯”ã€Œè‰ºæœ¯å®¶ã€å®‰å…¨ï¼Œåƒæ˜¯ã€Œçš®å…‹æ–¯ã€ä¹Ÿæ˜¯æ”¯æŒçš„ã€‚
- æ›´ç¨³å¦¥çš„åšæ³•æ˜¯é‡‡ç”¨å·²æ•…è‰ºæœ¯å®¶æˆ–å¯¹åº”çš„é£æ ¼ï¼Œå¦‚ã€Œæ¢µé«˜ã€ã€ã€Œè’™å¨œä¸½èã€ç­‰ã€‚
</Warning>

## æ¨¡å‹å’Œè´¹ç‡

| æ¨¡å‹ | è´¨é‡ | 1024x1024 | 1024x1536 | 1536x1024 |
| ------------------ | ------------ | ------------ | ------------ | ------------ |
| gpt-image-1 | low | $0.011 | $0.016 | $0.016 |
| gpt-image-1 | medium | $0.042 | $0.063 | $0.063 |
| gpt-image-1 | high | $0.167 | $0.25 | $0.25 |

<Info>
æ³¨æ„ï¼šè¾“å…¥æ–‡æœ¬ Token éƒ¨åˆ†çš„è´¹ç‡æ˜¯ $5/ç™¾ä¸‡ Tokensï¼Œé¢å¤–è®¡ç®—ã€‚
</Info>
  
## è°ƒç”¨æ–¹æ³•

**ç«¯ç‚¹ (Endpoints)**
1. ç»˜å›¾ï¼š`https://aihubmix.com/v1/images/generations`
2. ç¼–è¾‘ï¼š`https://aihubmix.com/v1/images/edits`

**Python è°ƒç”¨ç¤ºä¾‹å¦‚ä¸‹ï¼š**  
<CodeGroup>
```py ç”Ÿæˆ (æ–‡ç”Ÿå›¾)
from openai import OpenAI
import base64
import os

client = OpenAI(
    api_key="AIHUBMIX_API_KEY", # æ¢æˆä½ åœ¨åå°ç”Ÿæˆçš„ Key "sk-***"
    base_url="https://aihubmix.com/v1"
)

prompt = """redesign poster of the movie [Black Swan], 3D cartoon, smooth render, bright tone, 2:3 portrait."""

result = client.images.generate(
    model="gpt-image-1",
    prompt=prompt,
    n=1, # å•æ¬¡å‡ºå›¾æ•°é‡ï¼Œæœ€å¤š 10 å¼ 
    size="1024x1536", # 1024x1024 (square), 1536x1024 (3:2 landscape), 1024x1536 (2:3 portrait), auto (default) 
    quality="high", # high, medium, low, auto (default)
    moderation="low", # low, auto (default) éœ€è¦å‡çº§ openai åŒ… ğŸ“
    background="auto", # transparent, opaque, auto (default)
)

print(result.usage)

# å®šä¹‰æ–‡ä»¶åå‰ç¼€å’Œä¿å­˜ç›®å½•
output_dir = "." # å¯ä»¥æŒ‡å®šå…¶ä»–ç›®å½•
file_prefix = "image_gen"

# ç¡®ä¿è¾“å‡ºç›®å½•å­˜åœ¨
os.makedirs(output_dir, exist_ok=True)

# éå†æ‰€æœ‰è¿”å›çš„å›¾ç‰‡æ•°æ®
for i, image_data in enumerate(result.data):
    image_base64 = image_data.b64_json
    if image_base64: # ç¡®ä¿ b64_json ä¸ä¸ºç©º
        image_bytes = base64.b64decode(image_base64)

        # --- æ–‡ä»¶åå†²çªå¤„ç†é€»è¾‘å¼€å§‹ ---
        current_index = i
        while True:
            # æ„å»ºå¸¦è‡ªå¢åºå·çš„æ–‡ä»¶å
            file_name = f"{file_prefix}_{current_index}.png"
            file_path = os.path.join(output_dir, file_name) # æ„å»ºå®Œæ•´æ–‡ä»¶è·¯å¾„

            # æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨
            if not os.path.exists(file_path):
                break # æ–‡ä»¶åä¸å†²çªï¼Œè·³å‡ºå¾ªç¯

            # æ–‡ä»¶åå†²çªï¼Œå¢åŠ åºå·
            current_index += 1

        # ä½¿ç”¨æ‰¾åˆ°çš„å”¯ä¸€ file_path ä¿å­˜å›¾ç‰‡åˆ°æ–‡ä»¶
        with open(file_path, "wb") as f:
            f.write(image_bytes)
        print(f"å›¾ç‰‡å·²ä¿å­˜è‡³ï¼š{file_path}")
    else:
        print(f"ç¬¬ {i} å¼ å›¾ç‰‡æ•°æ®ä¸ºç©ºï¼Œè·³è¿‡ä¿å­˜ã€‚")

```

```py ç¼–è¾‘ (å¤šå›¾+æ–‡ç”Ÿå›¾)
from openai import OpenAI
import base64
import os

client = OpenAI(
    api_key="AIHUBMIX_API_KEY", # æ¢æˆä½ åœ¨åå°ç”Ÿæˆçš„ Key "sk-***"
    base_url="https://aihubmix.com/v1"
)

prompt = """redesign poster of the movie [Black Swan], 3D cartoon, smooth render, bright tone, 2:3 portrait."""

result = client.images.edit(
    model="gpt-image-1",
    image=open("yourpath/edit.jpg", "rb"), #å¤šå‚è€ƒå›¾åº”ä½¿ç”¨ [åˆ—è¡¨ï¼Œ]
    n=2, # å•æ¬¡æ•°é‡
    prompt=prompt,
    size="1024x1536", # 1024x1024 (square), 1536x1024 (3:2 landscape), 1024x1536 (2:3 portrait), auto (default)
    # moderation="low", # edit ä¸æ”¯æŒ moderation
    quality="high" # high, medium, low, auto (default)
)

print(result.usage)

# å®šä¹‰æ–‡ä»¶åå‰ç¼€å’Œä¿å­˜ç›®å½•
output_dir = "." # å¯ä»¥æŒ‡å®šå…¶ä»–ç›®å½•
file_prefix = "image_edit" # ä¿®æ”¹æ–‡ä»¶åå‰ç¼€

# ç¡®ä¿è¾“å‡ºç›®å½•å­˜åœ¨
os.makedirs(output_dir, exist_ok=True)

# --- éå† API è¿”å›çš„æ¯å¼ å›¾ç‰‡æ•°æ® ---
for i, image_item in enumerate(result.data):
    image_base64 = image_item.b64_json
    if image_base64 is None:
        print(f"è­¦å‘Šï¼šç¬¬ {i+1} å¼ å›¾ç‰‡æ²¡æœ‰è¿”å› base64 æ•°æ®ï¼Œè·³è¿‡ä¿å­˜ã€‚")
        continue # å¦‚æœæ²¡æœ‰ b64_json æ•°æ®ï¼Œè·³åˆ°ä¸‹ä¸€å¼ å›¾ç‰‡

    image_bytes = base64.b64decode(image_base64)

    # --- ä¸ºå½“å‰å›¾ç‰‡å¯»æ‰¾ä¸å†²çªçš„æ–‡ä»¶å ---
    current_index = 0 # æ¯æ¬¡éƒ½ä» 0 å¼€å§‹æ£€æŸ¥ï¼Œæˆ–è€…ç»´æŠ¤ä¸€ä¸ªå…¨å±€é€’å¢çš„ç´¢å¼•
    while True:
        # æ„å»ºå¸¦è‡ªå¢åºå·çš„æ–‡ä»¶å
        file_name = f"{file_prefix}_{current_index}.png"
        file_path = os.path.join(output_dir, file_name) # æ„å»ºå®Œæ•´æ–‡ä»¶è·¯å¾„

        # æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨
        if not os.path.exists(file_path):
            break # æ–‡ä»¶åä¸å†²çªï¼Œè·³å‡ºå†…éƒ¨å¾ªç¯

        # æ–‡ä»¶åå†²çªï¼Œå¢åŠ åºå·
        current_index += 1

    # ä½¿ç”¨æ‰¾åˆ°çš„å”¯ä¸€ file_path ä¿å­˜å½“å‰å›¾ç‰‡åˆ°æ–‡ä»¶
    try:
        with open(file_path, "wb") as f:
            f.write(image_bytes)
        print(f"ç¬¬ {i+1} å¼ ç¼–è¾‘åçš„å›¾ç‰‡å·²ä¿å­˜è‡³ï¼š{file_path}")
    except Exception as e:
        print(f"ä¿å­˜ç¬¬ {i+1} å¼ å›¾ç‰‡æ—¶å‡ºé”™ ({file_path}): {e}")
```
</CodeGroup>
æ›´å¤šçš„å‚æ•°ç»†èŠ‚å¯ä»¥å‚è€ƒ [OpenAI å®˜æ–¹æ–‡æ¡£](https://platform.openai.com/docs/api-reference/images/create)

## è¾“å‡ºç¤ºä¾‹
<CodeGroup>
```json ç”Ÿæˆ
Usage(input_tokens=150, input_tokens_details=UsageInputTokensDetails(image_tokens=0, text_tokens=150), output_tokens=6240, total_tokens=6390)
å›¾ç‰‡å·²ä¿å­˜è‡³ï¼š./image_gen_14.png
```

```json ç¼–è¾‘
Usage(input_tokens=992, input_tokens_details=UsageInputTokensDetails(image_tokens=646, text_tokens=346), output_tokens=12480, total_tokens=13472)
ç¬¬ 1 å¼ ç¼–è¾‘åçš„å›¾ç‰‡å·²ä¿å­˜è‡³ï¼š./image_edit_1.png
ç¬¬ 2 å¼ ç¼–è¾‘åçš„å›¾ç‰‡å·²ä¿å­˜è‡³ï¼š./image_edit_2.png
```
</CodeGroup>

## è¢«æ‹’çš„æƒ…å†µ

è¯·æ±‚è¢«æ‹’çš„é”™è¯¯ä¿¡æ¯å¦‚ä¸‹ï¼š
```json
Error code: 400 - {'error': {'message': 'Your request was rejected as a result of our safety system. Your request may contain content that is not allowed by our safety system.', 'type': 'user_error', 'param': None, 'code': 'moderation_blocked'}}
```

## å®ç”¨æç¤º

<Tip>
- æ”¯æŒä»»ä½•è¯­è¨€ï¼Œä¸­æ–‡ç»˜åˆ¶ä¹Ÿå¾ˆç¨³å®šï¼Œä½†æˆ‘ä»¬ä¹Ÿä¸å»ºè®®ç»˜åˆ¶å¤§é‡çš„æ–‡æœ¬
- size å‚æ•°ä¸æ”¯æŒæ˜¾ç¤ºä¼ å…¥ size="auto"ï¼Œé»˜è®¤å³ auto
- ç”»å¹…æ¯”ä¾‹å¯ä»¥åœ¨ prompt ä¸­æŒ‡å®šï¼Œæ”¯æŒ 2:3ã€3:2ã€1:1ï¼Œä¹Ÿå¯ä»¥åœ¨ size å‚æ•°ä¸­è®¾ç½®ã€‚
- æ”¯æŒæ§åˆ¶æ•æ„Ÿåº¦çš„ `moderation` å‚æ•°ï¼Œä½†è¿™ä¸ªå‚æ•°è®¾ä¸º low ä¹Ÿå¯èƒ½è¢«æ‹’ï¼Œæ¯”å¦‚è¯´ç»´çº³æ–¯è¿‡äºæš´éœ²
- edits ç«¯å£ä¸æ”¯æŒ `moderation` å‚æ•°
- æ–‡æœ¬æè¿°å’Œå‚è€ƒå›¾æ­é…ï¼Œèå›¾æ•ˆæœæ›´å‡†ç¡®
- ä¸Šä¼ çš„å›¾ç‰‡å¯ä»¥åšå‹ç¼©é¢„å¤„ç†ï¼Œæå‡é€Ÿåº¦
- æ”¯æŒé€æ˜èƒŒæ™¯ï¼Œå…æŠ å›¾ã€‚â€”â€”åªéœ€è¦åœ¨ Prompt ä¸­è¡¥å……è¦æ±‚
</Tip>